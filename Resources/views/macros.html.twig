{#
    Renders datagrid widget

    parameters:
        name: datagrid name
        params: additional parameters for url
#}
{% macro renderGrid(name, params = {}) %}
    {% set url = path('oro_datagrid_index', { 'gridName': name }|merge(params)) %}
    {% set metaData = oro_datagrid_metadata(name, { url: url }) %}

    <div data-type="datagrid" data-data="{{ render(url)|escape }}" data-metadata="{{ metaData|json_encode }}"></div>
    <script type="text/javascript">
        {# @TODO add dynamic modules to metadata #}
        {# {{ metaData.requireJSModules|json_encode|raw }} #}
        require(['jquery', 'oro/datagrid-builder'].concat([]),
                function ($, datagridBuilder) {
                    $(function () {
                        datagridBuilder();
                        {# @TODO remove dev code #}
                        $('div[data-type="datagrid"]:not([data-rendered])').each(function (e, el) {
                            el = $(el);
                            console.group('Datagrid "{{ name }}" rendered:');
                            console.info(el.data('data'));
                            console.info(el.data('metadata'));
                            console.groupEnd();
                        });
                    });
                });
    </script>
{% endmacro %}
